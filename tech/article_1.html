<!DOCTYPE html>
<html lang = "ja">
  <head>
    <meta charset = "UTF-8">
    <meta name="description">
    <title>TECH_NOTES (Issaku Kawashima)</title>
    <link href = "prettify.css" rel = "stylesheet" type = "text/css" media = "all">
    <link href = "tech.css" rel = "stylesheet" type = "text/css" media = "all">
    <script src="js/prettify.js"></script>
    <script src="js/lang-matlab.js"></script>
  </head>
  <body>
    <header>
      <h1>ドライ電極脳波計HD-72を使う</h1>
      <p>
        執筆日：2018年2月21日<br>
        環境：Windows10
      </p>
    </header>
    <section>
      <h2>1. HD-72の概要</h2>
      <p>
        <a href="http://cognionics.com/index.php/products/hd-eeg-systems/72-channel-system">
          Cognionics製 HD-72</a>は、64個のドライ電極を手軽に装着できる脳波計です。<br>
        無線（Bluetooth）でPCへデータを飛ばすので、被験者の拘束が少なく済みます。<br>
        なので、運動中の脳波測定にも向いているようです（アーティファクトの処理が大変そうですが）。<br>
        ただし、頭の大きさによって電極の配置が微妙に異なってしまうようです。<br>
        精密な測定を要する基礎研究よりも、ニューロフィードバックなどの応用に向いているのかと思います。<br>
        お値段はざっくり、車一台買えるくらいのイメージです。
      </p>
        <img src="article_1/pic_1.JPG">
      <p>
        HD-72ひとセット<br>
        持ち運んだりする際は、電極同士が接触して摩耗しないよう綿を挟んでいます。<br>
				3Dプリンタで作ったような質感（らしい）のプラスチックです。
      </p>
        <img src="article_1/pic_2.JPG">
        <img src="article_1/pic_3.JPG">
      <p>
        付属品がいくつか。<br>
        電極を掃除するためのブラシ（電動）。<br>
        バッテリーと充電器。
      </p>
      <p>
        ドライ電極とは、電極と皮膚の間の通電性を良くするために、ペーストや電解液などを頭皮に付ける必要がないものです。<br>
        普通の電極であればノイズを拾いまくってしまって測定になりません。<br>
        しかし、HD-72に搭載されているようなドライ電極は、アクティブ電極と呼ばれる仕組みによりノイズを軽減しています。<br>
        これは、電極ひとつひとつにアンプを内蔵し、拾った脳波にノイズが混入する前に増幅するもの、だそうです。<br>
      </p>
        <img src="article_1/pic_4.JPG">
      <p>
        裏側はこんなふうになっています。
      </p>
        <img src="article_1/pic_5.JPG">
      <p>
        ひとつひとつの電極はボタンでくっついており、簡単に外れ（てしまい）ます。<br>
        このタコ足のどれか一脚が頭皮に接触していれば、その電極の脳波を取得できるとか。
      </p>
        <img src="article_1/pic_6.JPG">
      <p>
        フラットな電極も付属していて、付替えが可能です。<br>
        額の部分なんかには、これを使ってもよいようです。
      </p>
        <img src="article_1/pic_7.JPG">
        <img src="article_1/pic_8.JPG">
      <p>
        後ろ側にバッテリーや送信機がついています。<br>
        ３次元の加速度計も内蔵されています。<br>
        電源スイッチもここです。<br>
        結構柔らかいスイッチで、装着しているうちにいつのまにかオフになってたりしがちです。<br>
      </p>
        <img src="article_1/pic_9.JPG">
      <p>
        受信機はUSBでPCに挿します。
      </p>
    </section>
    <section>
      <h2>2. HD-72とデータ取得ソフトウェアの接続</h2>
      <p>
        HD-72を始めとするCognionics製品は、Cognionics Data Acquisition.exeというソフトで制御します。<br>
        ソフトは
        <a href="http://cognionics.com/wiki/pmwiki.php/Main/DataAcquisitionSoftware">
          ここ
        </a>
        からダウンロードできます。<br>
        ソフトを開くと、右側のメニューに装置名が表示されます。
      </p>
        <img src="article_1/pic_10.PNG">
			<aside class="ts">
				<h4>TROUBLE SHOOTING: [ftd2xx.dll]が無い的なエラーが表示される</h4>
				<p>
					デバイスマネージャーを確認してください。<br>
					挿した受信機がうまく認識されていない可能性があります。<br>
					該当デバイスのプロパティを開いて、[ドライバーの更新]→[ドライバーソフトウェアの最新版を自動検索]をしてください<br>
					その後ソフトを再起動すると解決するかもしれません。
				</p>
			</aside>
			<p>
        クリックして[Connection]を選び、少し待ちます。<br>
        [Attempt to Auto-Configure?]のメッセージに[はい]と答えます。<br>
        少し（5秒くらい？）時間がかかりますが、デバイス設定画面が出てきます。
      </p>
        <img src="article_1/pic_11.PNG">
      <p>
        Sample Rateはここで変えましょう。<br>
        ただし、サポートされているRateは500までだそうです（代理店営業の方曰く）<br>
        1000Hzで起動させたところ、謎のスパイクノイズと謎のトリガが入るバグが生じました。<br>
        一覧表示された電極名をクリックすると、その電極の測定のオン・オフを切り替えられます。<br>
        [Write to Device and Start]をクリックします。<br>
        画面左側にグラフが表示されればOKです。
      </p>
        <img src="article_1/pic_12.PNG">
      <p>
        こんな感じに。<br>
				今はまだ脳波計をつけてないので、その辺の電波を拾っているだけです。
      </p>
    <section>
      <h2>2. HD-72の装着</h2>
      <p>
        ざっくりかぶせます。
      </p>
        <img src="article_1/pic_13.JPG">
      <p>
        あらかじめCz（あるいは重要な電極）の位置を測っておいて、そこに合わせるのがいいかと思います。<br>
        が、いずれにせよ装着位置はざっくりになってしまいそうです。<br>
        左右くらいはまっすぐになるように調整しましょう。
      </p><p>
        あご紐を締めます。
      </p>
        <img src="article_1/pic_14.JPG">
        <img src="article_1/pic_15.JPG">
      <p>
        留め具部分は、スライドして噛ませるようになっています。
      </p>
      <p>
        ベルトを締めていきます。
      </p>
        <img src="article_1/pic_16.JPG">
        <img src="article_1/pic_17.JPG">
      <p>
        各ネジの横についているボタンが飛び出ている状態であることを確認します。<br>
        ボタンが引っ込んでいる状態の場合は、飛び出た状態にします。<br>
        ネジを下にスライドさせるか、時計方向に回すとボタンが飛び出ます。<br>
        この状態で、ネジを時計回りに巻きます。<br>
        これによってベルトが巻き取られ、締められていきます。<br>
        全体を均等に締めて、すべての電極が頭皮に接触するようにしましょう。<br>
        ちなみに手元にあるこのHD-72は、何故か一部のボタンが固いようです。<br>
        結構ガチャガチャとネジを動かしてようやくボタンが出てきます。
      </p>
      <p>
        グラウンドとリファレンスを左右の耳たぶにクリップでつければ完成です。
      </p>
        <img src="article_1/pic_18.JPG">
        <img src="article_1/pic_19.JPG">
      <p>
        電極が刺さるような感じもなく、それほどは重くもなく、意外に装着ストレスは少ないです（個人の感想）。
      </p>
    </section>
    <section>
      <h2>3. データ取得ソフトウェアを使用する</h2>
      <p>
        きちんと装着ができると、データ取得ソフトに脳波が表示されます。<br>
			</p>
				<img src="article_1/pic_20.PNG">
			<p>
        Displayタブにある[Record]を押すと、その時からの脳波を記録することができます（上記画像はDeviceタブ）。<br>
        簡易に測定をするならこれで十分でしょう。<br>
        [Start LabStreamingLayer]をクリックすると、別のPCに脳波のデータを送ることができます。<br>
        これが結構便利なのです。
      </p><p>
        メニューのうち[Display]タブからは、脳波の表示設定を変えることができます。<br>
        初期設定だと64本の波形が1ページに表示されていてわかりにくいです。<br>
        [Channel: All/pages]となっているのをクリックして、[8/pages]あたりに設定しましょう。<br>
        また、縦軸のスケールを示す[Scale(EEG):]も200μVくらいにするのがわかりやすいかと思います。<br>
				Mask Hi-Z ChannelsのThresholdを超える電気抵抗の電極波形は表示されません。
      </p><p>
        [Channels]タブから、各電極の電気抵抗を確認することができます。<br>
        右下の三角マークをクリックすると別ウィンドウに拡大することもできます。
      </p>
    </section>
    <section>
      <h2>4. 測定の精度を高める</h2>
      <p>
        ソフトウェアで脳波や電気抵抗を確認しながら電極の接触具合を調整します。<br>
        まず、[Display]タブから電気抵抗値を確認しましょう。<br>
				右下の三角形をクリックすると、拡大表示も可能です
			</p>
				<img src="article_1/pic_21.PNG">
				<img src="article_1/pic_22.PNG">
			<p>
        赤く表示されている電極は電気抵抗が高く、緑は低いことを示しています。<br>
        レッドになっている電極の接触を再確認しましょう。<br>
        髪の毛を耳かきのような棒でかき出したり、ベルトをより強く締めたり、電極をグリグリしたりします。<br>
        すべてグリーンになれば最良です。<br>
        しかし、必ずしもそうする必要はないとのことです（営業さん曰く）。<br>
        最終的には、脳波形を目視してイケるかどうか確認してほしいとのことです（営業さん曰く）。
			</p>
				<img src="article_1/pic_23.PNG">
				<img src="article_1/pic_24.PNG">
			<p>
        線が太く見える（左）のは、部屋の電源から発生する50Hz（関西だと60Hz）のハムノイズが乗っているためです。<br>
        太線だったり、線が上下に飛び跳ねている電極は調整しましょう。<br>
        さらに、下記3点を確認してみましょう。<br>
        ・まばたきをすると、スパイク状のアーティファクトが入る<br>
        ・食いしばりをすると、ノイズが入る（線が極太になる）<br>
        ・目を閉じると、α波が出現する。<br>
      </p><p>
        α波とは、脳波のうち大体8-13Hzの、ゆったりとした周波成分を指します。<br>
        リラックスすると出現する脳波として有名で、目を閉じると、特に後頭に見られます。<br>
        脳波のギザギザが、なんというか、ゆるやかになればそれがα波だそうです。<br>
        目を開けている時と閉じている時とで、ギザギザの間隔が変わらないか見てみましょう。<br>
        ただこのα波は、はっきり現れる人と現れないい人がいるそうです。
			</p>
				<img src="article_1/pic_25.PNG">
      <p>
				これは、かなりはっきりと出るらしい人のα波です。<br>
				目を閉じてる区間の脳波が、開いている時の区間のものと違うことがなんとなくわかります。
			</p>
        波形が全体的にいい感じになれば準備はOKです。<br>
		</section>
		<section>
      <h2>4. HD-72を取り外す</h2>
      <p>
				測定が終わったら脳波計を外しましょう。<br>
				耳たぶに挟んだクリップを外し、顎ひもを外し、脳波計を上に持ち上げればそれで外れます。<br>
			</p><p>
				次の測定のために、巻き取ったベルトを緩めておきましょう。<br>
				先程ベルトを締めるために使ったネジを上へスライドさせ、ボタンを押します。<br>
				すると、ボタンが引っ込んだ状態になるので、これで緩めることができます。<br>
				緩める時には、（なんと）手でベルトを引っ張り出します。
			</p>
				<img src="article_1/pic_26.jpeg">
			<p>
				ちょっとドキドキするほど強めに引っ張ります。<br>
				すると、カラカラと音を出しながら巻き取られたベルトが戻ります。<br>
				注意点として、ネジと反対側の、ベルトが付着している部分に力がかからないようにしましょう。<br>
				引っこ抜けてしまうことがあるようです。<br>
			</p>
				<img src="article_1/pic_27.jpeg">
			<p>
				やらかした<br>
        （代理店の方がさっと直してくださいました）
			</p>
		<section>
			<p>
				以上、HD-72を使うための基礎知識でした。<br>
        別の記事に、MATLABやOpenVibeというソフトでデータ取得を制御する記事を書いています。<br>
        そちらもどうぞ。<br>
      </p>
      <ul>
        <li><a href="./article_3.html">LabStreamingLayerで脳波データをMATLABへ飛ばす</a></li>
        <li><a href="./article_2.html">Open ViBEでP300 Speller を実践する</a></li>
      </ul>
    </section>
    <footer>
      <hr>
      <p>
      トップページへ戻る：
      <a href="../index.html">
        川島一朔のHP</a>
      </p>
    </footer>
    <script>prettyPrint();</script>
  </body>
</html>
